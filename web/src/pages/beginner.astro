---
import Layout from '../layouts/Layout.astro';
import fs from 'node:fs';
import path from 'node:path';

// Check maintenance mode
const settingsPath = path.resolve(process.cwd(), '../src/data/settings.json');
let maintenanceMode = import.meta.env.PUBLIC_MAINTENANCE_MODE === 'true';

if (!maintenanceMode) {
  try {
    const raw = fs.readFileSync(settingsPath, 'utf-8');
    const settings = JSON.parse(raw);
    maintenanceMode = settings.maintenance_mode === true;
  } catch (e) {}
}

const configTemplate = `{
  "mcpServers": {
    "filesystem": {
      "command": "npx",
      "args": [
        "-y",
        "@modelcontextprotocol/server-filesystem",
        "/path/to/your/documents",
        "/path/to/your/projects"
      ]
    },
    "fetch": {
      "command": "uvx",
      "args": [
        "mcp-server-fetch"
      ]
    },
    "brave-search": {
      "command": "npx",
      "args": [
        "-y",
        "@modelcontextprotocol/server-brave-search"
      ],
      "env": {
        "BRAVE_API_KEY": "YOUR_API_KEY_HERE"
      }
    }
  }
}`;
---

<Layout title="Beginner's Guide - MCP Insider">
  {maintenanceMode ? (
    <div class="text-center py-20">
      <h1 class="text-4xl font-bold text-gray-800 mb-4">🔧 Maintenance Mode</h1>
      <p class="text-gray-600">The site is currently undergoing an update. Please check back later.</p>
    </div>
  ) : (
    <div class="max-w-4xl mx-auto space-y-12 pb-12">
      
      {/* Hero Section */}
      <section class="text-center space-y-6 pt-8 pb-12 border-b border-gray-100/50">
        <h1 class="text-4xl md:text-5xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-indigo-600 tracking-tight leading-tight">
          まだ手作業で調べ物してるの？<br/>
          <span class="text-gray-900 border-b-4 border-yellow-400">MCPでAIに全部任せよう！</span>
        </h1>
        <p class="text-lg text-gray-600 font-medium max-w-2xl mx-auto leading-relaxed">
          「使ってみたけどイマイチよくわからない…」そんなあなたへ。<br/>
          面倒なコピペや検索の手間をゼロにして、あなたの開発と日常を劇的にアップデートする「魔法の連携ツール」MCPの魅力をこっそり教えます。
        </p>
      </section>

      {/* Benefits Section (ジャパネット風のベネフィット提示) */}
      <section class="space-y-8">
        <h2 class="text-2xl font-bold text-gray-900 flex items-center gap-2 justify-center mx-auto text-center w-full">
          <svg class="w-8 h-8 text-yellow-500" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z" clip-rule="evenodd"></path></svg>
          MCPを手に入れたあなたの「新しい日常」
        </h2>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div class="bg-white/70 backdrop-blur-md rounded-2xl shadow-sm border border-white p-6 hover:shadow-md transition-all">
            <h3 class="text-xl font-extrabold text-blue-700 mb-3 flex items-center gap-2">
              <span class="text-2xl">🪄</span> PCのファイルを直接読んでくれる！
            </h3>
            <p class="text-gray-700 font-medium leading-relaxed">
              いちいちコードをコピーしてAIのチャット欄に貼り付けていませんか？MCPを繋げば、「あのフォルダにあるファイルを読んで、修正案出して」と言うだけで、AIが勝手にローカルファイルを読み込んでくれます。
            </p>
          </div>
          
          <div class="bg-white/70 backdrop-blur-md rounded-2xl shadow-sm border border-white p-6 hover:shadow-md transition-all">
            <h3 class="text-xl font-extrabold text-indigo-700 mb-3 flex items-center gap-2">
              <span class="text-2xl">🌐</span> 勝手に最新情報をググってくれる！
            </h3>
            <p class="text-gray-700 font-medium leading-relaxed">
              AIの「知識が古い問題」はもう過去のこと。「最新のReactのフックについて調べてドキュメント作って」と頼むだけで、AI自身が検索エンジンを使って最新の正解を取ってきてくれます。
            </p>
          </div>
        </div>
      </section>

      {/* Recommended Servers Section */}
      <section class="bg-gradient-to-br from-blue-50/50 to-purple-50/50 rounded-3xl p-8 sm:p-12 border border-white shadow-inner">
        <h2 class="text-2xl md:text-3xl font-bold text-gray-900 mb-8 text-center">
          これさえいれれば間違いない！<br/>初心者のための「鉄板サーバー三種の神器」
        </h2>

        <div class="space-y-6">
          {/* Filesystem */}
          <div class="bg-white/80 rounded-xl p-6 shadow-sm border border-white flex flex-col sm:flex-row gap-6 items-center sm:items-start group hover:bg-white transition-colors">
            <div class="w-16 h-16 rounded-2xl bg-blue-100 flex items-center justify-center text-blue-600 shrink-0">
              <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"></path></svg>
            </div>
            <div>
               <h3 class="text-lg font-bold text-gray-900 mb-1 flex items-center gap-2">
                 filesystem <span class="bg-blue-100 text-blue-700 text-xs px-2 py-0.5 rounded-full font-bold">超必須</span>
               </h3>
               <p class="text-sm text-gray-600 font-medium mb-2">あなたのPCの中身（指定したフォルダ）を、AIが自由に覗けるようにする魔法の扉です。「プロジェクト全体を見てバグを探して」が実現します。</p>
            </div>
          </div>

          {/* Fetch */}
          <div class="bg-white/80 rounded-xl p-6 shadow-sm border border-white flex flex-col sm:flex-row gap-6 items-center sm:items-start group hover:bg-white transition-colors">
            <div class="w-16 h-16 rounded-2xl bg-emerald-100 flex items-center justify-center text-emerald-600 shrink-0">
              <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"></path></svg>
            </div>
            <div>
               <h3 class="text-lg font-bold text-gray-900 mb-1 flex items-center gap-2">
                 fetch <span class="bg-emerald-100 text-emerald-700 text-xs px-2 py-0.5 rounded-full font-bold">超便利</span>
               </h3>
               <p class="text-sm text-gray-600 font-medium mb-2">指定したURLのWebページをAIにまるごと読ませるサーバーです。「このURLのAPIドキュメントを読んで、コードを書いて」が一瞬で伝わります。</p>
            </div>
          </div>

          {/* Brave Search */}
          <div class="bg-white/80 rounded-xl p-6 shadow-sm border border-white flex flex-col sm:flex-row gap-6 items-center sm:items-start group hover:bg-white transition-colors">
            <div class="w-16 h-16 rounded-2xl bg-orange-100 flex items-center justify-center text-orange-600 shrink-0">
              <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
            </div>
            <div>
               <h3 class="text-lg font-bold text-gray-900 mb-1 flex items-center gap-2">
                 brave-search
               </h3>
               <p class="text-sm text-gray-600 font-medium mb-2">AI自身にBrave検索エンジンを使わせる仕組みです。わからないことがあればAIが勝手にググって最新情報を補完してくれるようになります。（※無料のAPIキーが必要です）</p>
            </div>
          </div>
        </div>
      </section>

      {/* Setup Guide Section */}
      <section class="space-y-6 pt-6">
        <h2 class="text-2xl font-bold text-gray-900 text-center">
          1分で終わる！初めての導入ステップ
        </h2>
        <p class="text-center text-gray-600 font-medium mb-8">
          お使いのOSの指定フォルダにある設定ファイル（<code>claude_desktop_config.json</code>）を開き、<br/>
          以下のテンプレをコピペして保存するだけ！アプリを再起動すれば魔法の力が使えます。
        </p>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
          <div class="bg-gray-50 border border-gray-200 rounded-xl p-4">
            <h4 class="font-bold text-gray-800 mb-1 flex items-center gap-2">
              <svg class="w-4 h-4 text-gray-600" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zm3.22 13.9L14 17.1l-4.5-5.5v-2.1l4.5-5.5 1.22 1.2-3.88 4.7 3.88 4.7z"></path></svg>
              Mac 🍎
            </h4>
            <code class="text-xs text-rose-600 bg-white px-2 py-1 rounded block mt-2 border border-rose-100 overflow-x-auto whitespace-nowrap">~/Library/Application Support/Claude/claude_desktop_config.json</code>
          </div>
          <div class="bg-gray-50 border border-gray-200 rounded-xl p-4">
            <h4 class="font-bold text-gray-800 mb-1 flex items-center gap-2">
              <svg class="w-4 h-4 text-blue-600" fill="currentColor" viewBox="0 0 24 24"><path d="M0 3.449L9.75 2.1v9.451H0m10.949-9.602L24 0v11.4H10.949M0 12.6h9.75v9.451L0 20.699M10.949 12.6H24V24l-13.051-1.801"></path></svg>
              Windows / VSCode 🪟
            </h4>
            <code class="text-xs text-rose-600 bg-white px-2 py-1 rounded block mt-2 border border-rose-100 overflow-x-auto whitespace-nowrap">%APPDATA%\Claude\claude_desktop_config.json</code>
          </div>
        </div>

        <div class="bg-gray-900 rounded-2xl overflow-hidden shadow-xl relative group">
          <div class="bg-gray-800 px-4 py-3 flex items-center justify-between border-b border-gray-700">
            <div class="flex items-center gap-2">
              <div class="w-3 h-3 rounded-full bg-red-500"></div>
              <div class="w-3 h-3 rounded-full bg-yellow-500"></div>
              <div class="w-3 h-3 rounded-full bg-green-500"></div>
              <span class="text-xs text-gray-400 font-mono ml-2">claude_desktop_config.json</span>
            </div>
            
            <button id="copy-btn" class="text-xs bg-gray-700 hover:bg-gray-600 text-gray-300 hover:text-white px-3 py-1.5 rounded-md transition-colors flex items-center gap-1.5 focus:outline-none">
              <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>
              <span>Copy JSON</span>
            </button>
          </div>
          <div class="p-5 overflow-x-auto">
            <pre class="text-sm font-mono text-gray-300 leading-relaxed"><code id="config-code">{configTemplate}</code></pre>
          </div>
        </div>
        
        <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-r-lg mt-6 text-sm text-yellow-800 font-medium">
          <p><strong>💡 注意点:</strong> <code>/path/to/your/documents</code> などは、あなたがAIに読ませたい実際のPCのフォルダパス（例：Windowsなら <code>C:\\Users\\name\\Projects</code> ）に変更してください。</p>
        </div>
      </section>

      <div class="text-center pt-8">
        <a href={import.meta.env.BASE_URL} class="inline-flex items-center justify-center px-8 py-4 text-base font-bold text-white bg-blue-600 rounded-xl hover:bg-blue-700 transition-colors shadow-lg shadow-blue-600/30">
          トップページへ戻ってMCPを探す
        </a>
      </div>

    </div>
  )}
</Layout>

<script>
  // Copy to clipboard logic
  const copyBtn = document.getElementById('copy-btn');
  const configCode = document.getElementById('config-code');

  if (copyBtn && configCode) {
    copyBtn.addEventListener('click', async () => {
      try {
        await navigator.clipboard.writeText(configCode.textContent || '');
        const originalText = copyBtn.innerHTML;
        copyBtn.innerHTML = '<svg class="w-3.5 h-3.5 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg><span class="text-green-400">Copied!</span>';
        copyBtn.classList.add('bg-gray-800');
        
        setTimeout(() => {
          copyBtn.innerHTML = originalText;
          copyBtn.classList.remove('bg-gray-800');
        }, 2000);
      } catch (err) {
        console.error('Failed to copy!', err);
      }
    });
  }
</script>

      <div class="text-center pt-8">
        <a href={import.meta.env.BASE_URL} class="inline-flex items-center justify-center px-8 py-4 text-base font-bold text-white bg-blue-600 rounded-xl hover:bg-blue-700 transition-colors shadow-lg shadow-blue-600/30">
          トップページへ戻ってMCPを探す
        </a>
      </div>

    </div>
  )}
</Layout>
