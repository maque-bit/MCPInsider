---
import Layout from '../../layouts/Layout.astro';
import fs from 'node:fs';
import path from 'node:path';

export async function getStaticPaths() {
  const newsDataPath = path.join(process.cwd(), '../src/data/news_data.json');
  let news = [];
  try {
    if (fs.existsSync(newsDataPath)) {
      news = JSON.parse(fs.readFileSync(newsDataPath, 'utf-8'));
    }
  } catch (e) {}

  return news.map((item) => ({
    params: { slug: item.slug },
    props: { item },
  }));
}

const { item } = Astro.props;
---

<Layout title={`${item.title_ja || item.title} - AI News Summary`}>
  <div class="max-w-3xl mx-auto py-12">
    <a href={`${import.meta.env.BASE_URL}news/`} class="inline-flex items-center text-sm font-bold text-blue-600 hover:text-blue-800 transition-colors mb-8 group">
      <svg class="w-4 h-4 mr-2 group-hover:-translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
      Back to News
    </a>

    <header class="mb-10">
      <div class="flex items-center gap-3 mb-4">
        <span class="px-3 py-1 bg-blue-100 text-blue-700 text-xs font-bold rounded-full uppercase tracking-wider">
          {item.category}
        </span>
        <span class="text-sm text-gray-500 font-medium">
          {new Date(item.date).toLocaleDateString('ja-JP', { year: 'numeric', month: 'long', day: 'numeric' })}
        </span>
      </div>
      <h1 class="text-3xl sm:text-4xl font-black text-gray-900 leading-tight mb-6">
        {item.title_ja || item.title}
      </h1>
      <div class="flex items-center gap-2 text-sm text-gray-600 font-medium">
        <span class="text-gray-400">Source:</span>
        <span class="bg-gray-100 px-2 py-0.5 rounded text-gray-700">{item.source}</span>
      </div>
    </header>

    <div class="bg-white rounded-3xl p-8 sm:p-10 shadow-xl shadow-blue-100/50 border border-blue-50/50 relative overflow-hidden mb-12">
      <!-- Decoration -->
      <div class="absolute top-0 right-0 w-32 h-32 bg-blue-50/50 rounded-bl-full -z-0"></div>
      
      <div class="relative z-10">
        <h2 class="text-xl font-bold text-gray-900 mb-6 flex items-center gap-2">
          <svg class="w-6 h-6 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
          AI Summarization (Japanese)
        </h2>
        
        <div class="prose prose-blue max-w-none">
          <p class="text-lg text-gray-700 leading-relaxed font-medium">
            {item.summary_ja}
          </p>
        </div>
        
        <div class="mt-10 pt-8 border-t border-gray-100 flex flex-col sm:flex-row justify-between items-center gap-6">
          <p class="text-sm text-gray-500 italic">
            ※この記事はAIによって要約されました。
          </p>
          <a href={item.url} target="_blank" rel="noopener noreferrer" class="inline-flex items-center bg-gray-900 text-white px-6 py-3 rounded-xl font-bold hover:bg-gray-800 transition-all shadow-lg shadow-gray-200 group">
            原文を読む (External)
            <svg class="w-4 h-4 ml-2 group-hover:translate-x-1 group-hover:-translate-y-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path></svg>
          </a>
        </div>
      </div>
    </div>
  </div>
</Layout>
